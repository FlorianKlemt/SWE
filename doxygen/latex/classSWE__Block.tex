\section{S\-W\-E\-\_\-\-Block Class Reference}
\label{classSWE__Block}\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}}


{\ttfamily \#include $<$S\-W\-E\-\_\-\-Block.\-hh$>$}

Inheritance diagram for S\-W\-E\-\_\-\-Block\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.111111cm]{classSWE__Block}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void {\bf init\-Scenario} (float \-\_\-offset\-X, float \-\_\-offset\-Y, {\bf S\-W\-E\-\_\-\-Scenario} \&i\-\_\-scenario, const bool i\-\_\-multiple\-Blocks=false)
\begin{DoxyCompactList}\small\item\em initialise unknowns to a specific scenario\-: \end{DoxyCompactList}\item 
void {\bf set\-Water\-Height} (float($\ast$\-\_\-h)(float, float))
\begin{DoxyCompactList}\small\item\em set the water height according to a given function \end{DoxyCompactList}\item 
void {\bf set\-Discharge} (float($\ast$\-\_\-u)(float, float), float($\ast$\-\_\-v)(float, float))
\begin{DoxyCompactList}\small\item\em set the momentum/discharge according to the provided functions \end{DoxyCompactList}\item 
void {\bf set\-Bathymetry} (float \-\_\-b)
\begin{DoxyCompactList}\small\item\em set the bathymetry to a uniform value \end{DoxyCompactList}\item 
void {\bf set\-Bathymetry} (float($\ast$\-\_\-b)(float, float))
\begin{DoxyCompactList}\small\item\em set the bathymetry according to a given function \end{DoxyCompactList}\item 
const {\bf Float2\-D} \& {\bf get\-Water\-Height} ()
\begin{DoxyCompactList}\small\item\em provides read access to the water height array \end{DoxyCompactList}\item 
const {\bf Float2\-D} \& {\bf get\-Discharge\-\_\-hu} ()
\begin{DoxyCompactList}\small\item\em provides read access to the momentum/discharge array (x-\/component) \end{DoxyCompactList}\item 
const {\bf Float2\-D} \& {\bf get\-Discharge\-\_\-hv} ()
\begin{DoxyCompactList}\small\item\em provides read access to the momentum/discharge array (y-\/component) \end{DoxyCompactList}\item 
const {\bf Float2\-D} \& {\bf get\-Bathymetry} ()
\begin{DoxyCompactList}\small\item\em provides read access to the bathymetry data \end{DoxyCompactList}\item 
void {\bf set\-Boundary\-Type} ({\bf Boundary\-Edge} edge, {\bf Boundary\-Type} boundtype, const {\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$inflow=N\-U\-L\-L)
\begin{DoxyCompactList}\small\item\em set type of boundary condition for the specified boundary \end{DoxyCompactList}\item 
virtual {\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$ {\bf register\-Copy\-Layer} ({\bf Boundary\-Edge} edge)
\begin{DoxyCompactList}\small\item\em return a pointer to proxy class to access the copy layer \end{DoxyCompactList}\item 
virtual {\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$ {\bf grab\-Ghost\-Layer} ({\bf Boundary\-Edge} edge)
\begin{DoxyCompactList}\small\item\em \char`\"{}grab\char`\"{} the ghost layer in order to set these values externally \end{DoxyCompactList}\item 
void {\bf set\-Ghost\-Layer} ()
\begin{DoxyCompactList}\small\item\em set values in ghost layers \end{DoxyCompactList}\item 
float {\bf get\-Max\-Timestep} ()
\begin{DoxyCompactList}\small\item\em return maximum size of the time step to ensure stability of the method \end{DoxyCompactList}\item 
void {\bf compute\-Max\-Timestep} (const float i\-\_\-dry\-Tol=0.\-1, const float i\-\_\-cfl\-Number=0.\-4)
\item 
virtual void {\bf simulate\-Timestep} (float dt)
\begin{DoxyCompactList}\small\item\em execute a single time step (with fixed time step size) of the simulation \end{DoxyCompactList}\item 
virtual float {\bf simulate} (float t\-Start, float t\-End)
\item 
virtual void {\bf compute\-Numerical\-Fluxes} ()=0
\begin{DoxyCompactList}\small\item\em compute the numerical fluxes for each edge of the Cartesian grid \end{DoxyCompactList}\item 
virtual void {\bf update\-Unknowns} (float dt)=0
\begin{DoxyCompactList}\small\item\em compute the new values of the unknowns h, hu, and hv in all grid cells \end{DoxyCompactList}\item 
int {\bf get\-Nx} ()\label{classSWE__Block_aa27028fa4bc13bb2d9251b09e0fdfce6}

\begin{DoxyCompactList}\small\item\em returns \doxyref{nx}{p.}{classSWE__Block_a46ec0dc1157997bd255fb39924f1e2bb}, i.\-e. the grid size in x-\/direction \end{DoxyCompactList}\item 
int {\bf get\-Ny} ()\label{classSWE__Block_a4b65557b6f73ffb6454dad3dbf86e9ad}

\begin{DoxyCompactList}\small\item\em returns \doxyref{ny}{p.}{classSWE__Block_a3f139630d12423eb4bd7df3e45c7f5da}, i.\-e. the grid size in y-\/direction \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static const float {\bf g} = 9.\-81f\label{classSWE__Block_a073ca743ff4077a7e456906be704958f}

\begin{DoxyCompactList}\small\item\em static variable that holds the gravity constant (g = 9.\-81 m/s$^\wedge$2)\-: \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf S\-W\-E\-\_\-\-Block} (int l\-\_\-nx, int l\-\_\-ny, float l\-\_\-dx, float l\-\_\-dy)
\item 
virtual {\bf $\sim$\-S\-W\-E\-\_\-\-Block} ()
\item 
void {\bf set\-Boundary\-Bathymetry} ()
\item 
virtual void {\bf synch\-After\-Write} ()
\item 
virtual void {\bf synch\-Water\-Height\-After\-Write} ()
\item 
virtual void {\bf synch\-Discharge\-After\-Write} ()
\item 
virtual void {\bf synch\-Bathymetry\-After\-Write} ()
\item 
virtual void {\bf synch\-Ghost\-Layer\-After\-Write} ()
\item 
virtual void {\bf synch\-Before\-Read} ()
\item 
virtual void {\bf synch\-Water\-Height\-Before\-Read} ()
\item 
virtual void {\bf synch\-Discharge\-Before\-Read} ()
\item 
virtual void {\bf synch\-Bathymetry\-Before\-Read} ()
\item 
virtual void {\bf synch\-Copy\-Layer\-Before\-Read} ()
\item 
virtual void {\bf set\-Boundary\-Conditions} ()
\begin{DoxyCompactList}\small\item\em set boundary conditions in ghost layers (set boundary conditions) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
int {\bf nx}\label{classSWE__Block_a46ec0dc1157997bd255fb39924f1e2bb}

\begin{DoxyCompactList}\small\item\em size of Cartesian arrays in x-\/direction \end{DoxyCompactList}\item 
int {\bf ny}\label{classSWE__Block_a3f139630d12423eb4bd7df3e45c7f5da}

\begin{DoxyCompactList}\small\item\em size of Cartesian arrays in y-\/direction \end{DoxyCompactList}\item 
float {\bf dx}\label{classSWE__Block_af2262b1cce6834d939c5a2315dae49b1}

\begin{DoxyCompactList}\small\item\em mesh size of the Cartesian grid in x-\/direction \end{DoxyCompactList}\item 
float {\bf dy}\label{classSWE__Block_a9feb988748d792bca0ca0508e43bd87f}

\begin{DoxyCompactList}\small\item\em mesh size of the Cartesian grid in y-\/direction \end{DoxyCompactList}\item 
{\bf Float2\-D} {\bf h}\label{classSWE__Block_a64a0f8f437f38b5f3b8ec5b4abdb864e}

\begin{DoxyCompactList}\small\item\em array that holds the water height for each element \end{DoxyCompactList}\item 
{\bf Float2\-D} {\bf hu}\label{classSWE__Block_aec2c1278fdb23f083216d8d397f26060}

\begin{DoxyCompactList}\small\item\em array that holds the x-\/component of the momentum for each element (water height h multiplied by velocity in x-\/direction) \end{DoxyCompactList}\item 
{\bf Float2\-D} {\bf hv}\label{classSWE__Block_a0897aa3c2d78749f209c95e08196d831}

\begin{DoxyCompactList}\small\item\em array that holds the y-\/component of the momentum for each element (water height h multiplied by velocity in y-\/direction) \end{DoxyCompactList}\item 
{\bf Float2\-D} {\bf b}\label{classSWE__Block_af7487209129f40b26ea171762754a261}

\begin{DoxyCompactList}\small\item\em array that holds the bathymetry data (sea floor elevation) for each element \end{DoxyCompactList}\item 
{\bf Boundary\-Type} {\bf boundary} [4]\label{classSWE__Block_a0e56d0cad169abd4f5de95d9f96c7a73}

\begin{DoxyCompactList}\small\item\em type of boundary conditions at L\-E\-F\-T, R\-I\-G\-H\-T, T\-O\-P, and B\-O\-T\-T\-O\-M boundary \end{DoxyCompactList}\item 
const {\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$ {\bf neighbour} [4]\label{classSWE__Block_a5ea4ea4815af9eb66c51de9ad9b8d148}

\begin{DoxyCompactList}\small\item\em for C\-O\-N\-N\-E\-C\-T boundaries\-: pointer to connected neighbour block \end{DoxyCompactList}\item 
float {\bf max\-Timestep}
\begin{DoxyCompactList}\small\item\em maximum time step allowed to ensure stability of the method \end{DoxyCompactList}\item 
float {\bf offset\-X}\label{classSWE__Block_aa9e9b1fa797c133c4989e4c54f09b542}

\begin{DoxyCompactList}\small\item\em x-\/coordinate of the origin (left-\/bottom corner) of the Cartesian grid \end{DoxyCompactList}\item 
float {\bf offset\-Y}\label{classSWE__Block_aa05241101a66f0f0548eba6dbbaa1bbb}

\begin{DoxyCompactList}\small\item\em y-\/coordinate of the origin (left-\/bottom corner) of the Cartesian grid \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
\doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block} is the main data structure to compute our shallow water model on a single Cartesian grid block\-: \doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block} is an abstract class (and interface) that should be extended by respective implementation classes.

\paragraph*{Cartesian Grid for Discretization\-:}

S\-W\-E\-\_\-\-Blocks uses a regular Cartesian grid of size \doxyref{nx}{p.}{classSWE__Block_a46ec0dc1157997bd255fb39924f1e2bb} by \doxyref{ny}{p.}{classSWE__Block_a3f139630d12423eb4bd7df3e45c7f5da}, where each grid cell carries three unknowns\-:
\begin{DoxyItemize}
\item the water level \doxyref{h}{p.}{classSWE__Block_a64a0f8f437f38b5f3b8ec5b4abdb864e}
\item the momentum components \doxyref{hu}{p.}{classSWE__Block_aec2c1278fdb23f083216d8d397f26060} and \doxyref{hv}{p.}{classSWE__Block_a0897aa3c2d78749f209c95e08196d831} (in x-\/ and y-\/ direction, resp.)
\item the bathymetry \doxyref{b}{p.}{classSWE__Block_af7487209129f40b26ea171762754a261}
\end{DoxyItemize}

Each of the components is stored as a 2\-D array, implemented as a \doxyref{Float2\-D}{p.}{classFloat2D} object, and are defined on grid indices [0,..,\doxyref{nx}{p.}{classSWE__Block_a46ec0dc1157997bd255fb39924f1e2bb}+1]$\ast$[0,..,\doxyref{ny}{p.}{classSWE__Block_a3f139630d12423eb4bd7df3e45c7f5da}+1]. The computational domain is indexed with [1,..,\doxyref{nx}{p.}{classSWE__Block_a46ec0dc1157997bd255fb39924f1e2bb}]$\ast$[1,..,\doxyref{ny}{p.}{classSWE__Block_a3f139630d12423eb4bd7df3e45c7f5da}].

The mesh sizes of the grid in x-\/ and y-\/direction are stored in static variables \doxyref{dx}{p.}{classSWE__Block_af2262b1cce6834d939c5a2315dae49b1} and \doxyref{dy}{p.}{classSWE__Block_a9feb988748d792bca0ca0508e43bd87f}. The position of the Cartesian grid in space is stored via the coordinates of the left-\/bottom corner of the grid, in the variables \doxyref{offset\-X}{p.}{classSWE__Block_aa9e9b1fa797c133c4989e4c54f09b542} and \doxyref{offset\-Y}{p.}{classSWE__Block_aa05241101a66f0f0548eba6dbbaa1bbb}.

\paragraph*{Ghost layers\-:}

To implement the behaviour of the fluid at boundaries and for using multiple block in serial and parallel settings, \doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block} adds an additional layer of so-\/called ghost cells to the Cartesian grid, as illustrated in the following figure. Cells in the ghost layer have indices 0 or \doxyref{nx}{p.}{classSWE__Block_a46ec0dc1157997bd255fb39924f1e2bb}+1 / \doxyref{ny}{p.}{classSWE__Block_a3f139630d12423eb4bd7df3e45c7f5da}+1.



\paragraph*{Memory Model\-:}

The variables \doxyref{h}{p.}{classSWE__Block_a64a0f8f437f38b5f3b8ec5b4abdb864e}, \doxyref{hu}{p.}{classSWE__Block_aec2c1278fdb23f083216d8d397f26060}, \doxyref{hv}{p.}{classSWE__Block_a0897aa3c2d78749f209c95e08196d831} for water height and momentum will typically be updated by classes derived from \doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block}. However, it is not assumed that such and updated will be performed in every time step. Instead, subclasses are welcome to update \doxyref{h}{p.}{classSWE__Block_a64a0f8f437f38b5f3b8ec5b4abdb864e}, \doxyref{hu}{p.}{classSWE__Block_aec2c1278fdb23f083216d8d397f26060}, and \doxyref{hv}{p.}{classSWE__Block_a0897aa3c2d78749f209c95e08196d831} in a lazy fashion, and keep data in faster memory (incl. local memory of acceleration hardware, such as G\-P\-G\-P\-Us), instead.

It is assumed that the bathymetry data \doxyref{b}{p.}{classSWE__Block_af7487209129f40b26ea171762754a261} is not changed during the algorithm (up to the exceptions mentioned in the following).

To force a synchronization of the respective data structures, the following methods are provided as part of \doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block}\-:
\begin{DoxyItemize}
\item \doxyref{synch\-After\-Write()}{p.}{classSWE__Block_ae914f9bf6d4ef8f974f9f005114985e7} to synchronize \doxyref{h}{p.}{classSWE__Block_a64a0f8f437f38b5f3b8ec5b4abdb864e}, \doxyref{hu}{p.}{classSWE__Block_aec2c1278fdb23f083216d8d397f26060}, \doxyref{hv}{p.}{classSWE__Block_a0897aa3c2d78749f209c95e08196d831}, and \doxyref{b}{p.}{classSWE__Block_af7487209129f40b26ea171762754a261} after an external update (reading a file, e.\-g.);
\item \doxyref{synch\-Water\-Height\-After\-Write()}{p.}{classSWE__Block_aa2924833e29a795d8c04fb79bfe794de}, \doxyref{synch\-Discharge\-After\-Write()}{p.}{classSWE__Block_a94c34030153178c9d94f3f14be174eaf}, \doxyref{synch\-Bathymetry\-After\-Write()}{p.}{classSWE__Block_a4bece8aa90f67e55c40b91aab900febb}\-: to synchronize only \doxyref{h}{p.}{classSWE__Block_a64a0f8f437f38b5f3b8ec5b4abdb864e} or momentum (\doxyref{hu}{p.}{classSWE__Block_aec2c1278fdb23f083216d8d397f26060} and \doxyref{hv}{p.}{classSWE__Block_a0897aa3c2d78749f209c95e08196d831}) or bathymetry \doxyref{b}{p.}{classSWE__Block_af7487209129f40b26ea171762754a261};
\item \doxyref{synch\-Ghost\-Layer\-After\-Write()}{p.}{classSWE__Block_a4657993ebdb5f0132b077e63790d0b2b} to synchronize only the ghost layers
\item \doxyref{synch\-Before\-Read()}{p.}{classSWE__Block_a23d936cb9a4367092e5b2515f81fe819} to synchronize \doxyref{h}{p.}{classSWE__Block_a64a0f8f437f38b5f3b8ec5b4abdb864e}, \doxyref{hu}{p.}{classSWE__Block_aec2c1278fdb23f083216d8d397f26060}, \doxyref{hv}{p.}{classSWE__Block_a0897aa3c2d78749f209c95e08196d831}, and \doxyref{b}{p.}{classSWE__Block_af7487209129f40b26ea171762754a261} before an output of the variables (writing a visualization file, e.\-g.)
\item \doxyref{synch\-Water\-Height\-Before\-Read()}{p.}{classSWE__Block_a07c85681ab29106c3b164db969899ace}, \doxyref{synch\-Discharge\-Before\-Read()}{p.}{classSWE__Block_a3773dcb194212fb8cb40ab8465575aa1}, \doxyref{synch\-Bathymetry\-Before\-Read()}{p.}{classSWE__Block_a7c8258c6949518ca44f4e9ce89d33b09}\-: as \doxyref{synch\-Before\-Read()}{p.}{classSWE__Block_a23d936cb9a4367092e5b2515f81fe819}, but only for the specified variables
\item \doxyref{synch\-Copy\-Layer\-Before\-Read()}{p.}{classSWE__Block_a13c90d5a6596336013c41e73c8795f83}\-: synchronizes the copy layer only (i.\-e., a layer that is to be replicated in a neighbouring \doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block}.
\end{DoxyItemize}

\paragraph*{Derived Classes}

As \doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block} just provides an abstract base class together with the most important data structures, the implementation of concrete models is the job of respective derived classes (see the class diagram at the top of this page). Similar, parallel implementations that are based on a specific parallel programming model (such as Open\-M\-P) or parallel architecture (such as G\-P\-U/\-C\-U\-D\-A) should form subclasses of their own. Please refer to the documentation of these classes for more details on the model and on the parallelisation approach. 

\subsection{Constructor \& Destructor Documentation}
\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}}
\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{S\-W\-E\-\_\-\-Block}]{\setlength{\rightskip}{0pt plus 5cm}S\-W\-E\-\_\-\-Block\-::\-S\-W\-E\-\_\-\-Block (
\begin{DoxyParamCaption}
\item[{int}]{l\-\_\-nx, }
\item[{int}]{l\-\_\-ny, }
\item[{float}]{l\-\_\-dx, }
\item[{float}]{l\-\_\-dy}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{classSWE__Block_a114ed3bb6a8a2c482e5f94f768543b82}
Constructor\-: allocate variables for simulation

unknowns h (water height), hu,hv (discharge in x-\/ and y-\/direction), and b (bathymetry) are defined on grid indices [0,..,nx+1]$\ast$[0,..,ny+1] -\/$>$ computational domain is [1,..,nx]$\ast$[1,..,ny] -\/$>$ plus ghost cell layer

The constructor is protected\-: no instances of \doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block} can be generated. \index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!$\sim$\-S\-W\-E\-\_\-\-Block@{$\sim$\-S\-W\-E\-\_\-\-Block}}
\index{$\sim$\-S\-W\-E\-\_\-\-Block@{$\sim$\-S\-W\-E\-\_\-\-Block}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{$\sim$\-S\-W\-E\-\_\-\-Block}]{\setlength{\rightskip}{0pt plus 5cm}S\-W\-E\-\_\-\-Block\-::$\sim$\-S\-W\-E\-\_\-\-Block (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_a2ddff1c284663ba514985a3574def1b0}
Destructor\-: de-\/allocate all variables 

\subsection{Member Function Documentation}
\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!compute\-Max\-Timestep@{compute\-Max\-Timestep}}
\index{compute\-Max\-Timestep@{compute\-Max\-Timestep}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{compute\-Max\-Timestep}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::compute\-Max\-Timestep (
\begin{DoxyParamCaption}
\item[{const float}]{i\-\_\-dry\-Tol = {\ttfamily 0.1}, }
\item[{const float}]{i\-\_\-cfl\-Number = {\ttfamily 0.4}}
\end{DoxyParamCaption}
)}\label{classSWE__Block_acf2ff6617cbc0d3d837f0e618039cfe2}
Compute the largest allowed time step for the current grid block (reference implementation) depending on the current values of variables h, hu, and hv, and store this time step size in member variable max\-Timestep.


\begin{DoxyParams}{Parameters}
{\em i\-\_\-dry\-Tol} & dry tolerance (dry cells do not affect the time step). \\
\hline
{\em i\-\_\-cfl\-Number} & C\-F\-L number of the used method. \\
\hline
\end{DoxyParams}
\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!compute\-Numerical\-Fluxes@{compute\-Numerical\-Fluxes}}
\index{compute\-Numerical\-Fluxes@{compute\-Numerical\-Fluxes}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{compute\-Numerical\-Fluxes}]{\setlength{\rightskip}{0pt plus 5cm}virtual void S\-W\-E\-\_\-\-Block\-::compute\-Numerical\-Fluxes (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [pure virtual]}}\label{classSWE__Block_a94dcf2c6ae31731e4586e45628b0c00e}


compute the numerical fluxes for each edge of the Cartesian grid 

The computation of fluxes strongly depends on the chosen numerical method. Hence, this purely virtual function has to be implemented in the respective derived classes. 

Implemented in {\bf S\-W\-E\-\_\-\-Dimensional\-Splitting} \doxyref{}{p.}{classSWE__DimensionalSplitting_a84759f8fbbbfe1e46613375515826f0f}, {\bf S\-W\-E\-\_\-\-Wave\-Propagation\-Block\-S\-I\-M\-D} \doxyref{}{p.}{classSWE__WavePropagationBlockSIMD_a4aa15050ec1db113f54fff06539a900f}, {\bf S\-W\-E\-\_\-\-Wave\-Propagation\-Block} \doxyref{}{p.}{classSWE__WavePropagationBlock_a5f6335a38fb3cf38623326959f06baf4}, {\bf S\-W\-E\-\_\-\-Wave\-Propagation\-Block\-Cuda} \doxyref{}{p.}{classSWE__WavePropagationBlockCuda_a8a89bf61b9fc4433652f400ca8e564ed}, {\bf S\-W\-E\-\_\-\-Wave\-Accumulation\-Block} \doxyref{}{p.}{classSWE__WaveAccumulationBlock_acac0b73f22b256bc91a58ff8d0831e5d}, {\bf S\-W\-E\-\_\-\-Rusanov\-Block} \doxyref{}{p.}{classSWE__RusanovBlock_a78cdefa510cd2d88ca4e213f75b9b10b}, and {\bf S\-W\-E\-\_\-\-Rusanov\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__RusanovBlockCUDA_a64fa005a8f69f49ac7894dffcec39787}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!get\-Bathymetry@{get\-Bathymetry}}
\index{get\-Bathymetry@{get\-Bathymetry}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{get\-Bathymetry}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Float2\-D} \& S\-W\-E\-\_\-\-Block\-::get\-Bathymetry (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classSWE__Block_a98e2c99a335d11d09a1489d6873b5615}


provides read access to the bathymetry data 

return reference to bathymetry unknown b \index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!get\-Discharge\-\_\-hu@{get\-Discharge\-\_\-hu}}
\index{get\-Discharge\-\_\-hu@{get\-Discharge\-\_\-hu}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{get\-Discharge\-\_\-hu}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Float2\-D} \& S\-W\-E\-\_\-\-Block\-::get\-Discharge\-\_\-hu (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classSWE__Block_ae5e766626a1e3fee89625610e2c67f1f}


provides read access to the momentum/discharge array (x-\/component) 

return reference to discharge unknown hu \index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!get\-Discharge\-\_\-hv@{get\-Discharge\-\_\-hv}}
\index{get\-Discharge\-\_\-hv@{get\-Discharge\-\_\-hv}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{get\-Discharge\-\_\-hv}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Float2\-D} \& S\-W\-E\-\_\-\-Block\-::get\-Discharge\-\_\-hv (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classSWE__Block_aece9e8dc3f9b8ab27420e537c76daf7c}


provides read access to the momentum/discharge array (y-\/component) 

return reference to discharge unknown hv \index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!get\-Max\-Timestep@{get\-Max\-Timestep}}
\index{get\-Max\-Timestep@{get\-Max\-Timestep}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{get\-Max\-Timestep}]{\setlength{\rightskip}{0pt plus 5cm}float S\-W\-E\-\_\-\-Block\-::get\-Max\-Timestep (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classSWE__Block_a74da1eb712e639e47b5b848081b2afad}


return maximum size of the time step to ensure stability of the method 

\begin{DoxyReturn}{Returns}
current value of the member variable \doxyref{max\-Timestep}{p.}{classSWE__Block_a05cbc9b40e0483bf73dbc2bdeae7dee3} 
\end{DoxyReturn}
\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!get\-Water\-Height@{get\-Water\-Height}}
\index{get\-Water\-Height@{get\-Water\-Height}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{get\-Water\-Height}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Float2\-D} \& S\-W\-E\-\_\-\-Block\-::get\-Water\-Height (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classSWE__Block_ab1aea4294403c194180c3dc107339fd7}


provides read access to the water height array 

Restores values for h, v, and u from file data 
\begin{DoxyParams}{Parameters}
{\em \-\_\-b} & array holding b-\/values in sequence return reference to water height unknown h \\
\hline
\end{DoxyParams}
\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!grab\-Ghost\-Layer@{grab\-Ghost\-Layer}}
\index{grab\-Ghost\-Layer@{grab\-Ghost\-Layer}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{grab\-Ghost\-Layer}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$ S\-W\-E\-\_\-\-Block\-::grab\-Ghost\-Layer (
\begin{DoxyParamCaption}
\item[{{\bf Boundary\-Edge}}]{edge}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\label{classSWE__Block_a9a96c59444645e237d098803009158a3}


\char`\"{}grab\char`\"{} the ghost layer in order to set these values externally 

\char`\"{}grab\char`\"{} the ghost layer at the specific boundary in order to set boundary values in this ghost layer externally. The boundary conditions at the respective ghost layer is set to P\-A\-S\-S\-I\-V\-E, such that the grabbing program component is responsible to provide correct values in the ghost layer, for example by receiving data from a remote copy layer via M\-P\-I communication. 
\begin{DoxyParams}{Parameters}
{\em specified} & edge \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a \doxyref{S\-W\-E\-\_\-\-Block1\-D}{p.}{structSWE__Block1D} object that contains row variables h, hu, and hv 
\end{DoxyReturn}


Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_a266fd1b60d27be35103b089da72f1e6e}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!init\-Scenario@{init\-Scenario}}
\index{init\-Scenario@{init\-Scenario}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{init\-Scenario}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::init\-Scenario (
\begin{DoxyParamCaption}
\item[{float}]{\-\_\-offset\-X, }
\item[{float}]{\-\_\-offset\-Y, }
\item[{{\bf S\-W\-E\-\_\-\-Scenario} \&}]{i\-\_\-scenario, }
\item[{const bool}]{i\-\_\-multiple\-Blocks = {\ttfamily false}}
\end{DoxyParamCaption}
)}\label{classSWE__Block_a46b715c584468a5daa975ec1eb1ab947}


initialise unknowns to a specific scenario\-: 

Initializes the unknowns and bathymetry in all grid cells according to the given \doxyref{S\-W\-E\-\_\-\-Scenario}{p.}{classSWE__Scenario}.

In the case of multiple S\-W\-E\-\_\-\-Blocks at this point, it is not clear how the boundary conditions should be set. This is because an isolated \doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block} doesn't have any in information about the grid. Therefore the calling routine, which has the information about multiple blocks, has to take care about setting the right boundary conditions.


\begin{DoxyParams}{Parameters}
{\em i\-\_\-scenario} & scenario, which is used during the setup. \\
\hline
{\em i\-\_\-multiple\-Blocks} & are the multiple S\-W\-E\-\_\-blocks? \\
\hline
\end{DoxyParams}
\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!register\-Copy\-Layer@{register\-Copy\-Layer}}
\index{register\-Copy\-Layer@{register\-Copy\-Layer}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{register\-Copy\-Layer}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$ S\-W\-E\-\_\-\-Block\-::register\-Copy\-Layer (
\begin{DoxyParamCaption}
\item[{{\bf Boundary\-Edge}}]{edge}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\label{classSWE__Block_a827ee5c61dc9c1b472ac8b4e1c19956a}


return a pointer to proxy class to access the copy layer 

register the row or column layer next to a boundary as a \char`\"{}copy layer\char`\"{}, from which values will be copied into the ghost layer or a neighbour; \begin{DoxyReturn}{Returns}
a \doxyref{S\-W\-E\-\_\-\-Block1\-D}{p.}{structSWE__Block1D} object that contains row variables h, hu, and hv 
\end{DoxyReturn}


Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_a16660ec1c396be1fd1ace44aaa265d04}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!set\-Bathymetry@{set\-Bathymetry}}
\index{set\-Bathymetry@{set\-Bathymetry}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{set\-Bathymetry}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::set\-Bathymetry (
\begin{DoxyParamCaption}
\item[{float}]{\-\_\-b}
\end{DoxyParamCaption}
)}\label{classSWE__Block_af2ab34b138a14f2c295849f3b2acc5f3}


set the bathymetry to a uniform value 

set Bathymetry b in all grid cells (incl. ghost/boundary layers) to a uniform value bathymetry source terms are re-\/computed \index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!set\-Bathymetry@{set\-Bathymetry}}
\index{set\-Bathymetry@{set\-Bathymetry}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{set\-Bathymetry}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::set\-Bathymetry (
\begin{DoxyParamCaption}
\item[{float($\ast$)(float, float)}]{\-\_\-b}
\end{DoxyParamCaption}
)}\label{classSWE__Block_ad4214fcfd102a4c167d274ad87d9dd90}


set the bathymetry according to a given function 

set Bathymetry b in all grid cells (incl. ghost/boundary layers) using the specified bathymetry function; bathymetry source terms are re-\/computed \index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!set\-Boundary\-Bathymetry@{set\-Boundary\-Bathymetry}}
\index{set\-Boundary\-Bathymetry@{set\-Boundary\-Bathymetry}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{set\-Boundary\-Bathymetry}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::set\-Boundary\-Bathymetry (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{classSWE__Block_a6beb68dacde9c8479647c25c6a5cbcf5}
Sets the bathymetry on O\-U\-T\-F\-L\-O\-W or W\-A\-L\-L boundaries. Should be called very time a boundary is changed to a O\-U\-T\-F\-L\-O\-W or W\-A\-L\-L boundary {\bfseries or} the bathymetry changes. \index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!set\-Boundary\-Conditions@{set\-Boundary\-Conditions}}
\index{set\-Boundary\-Conditions@{set\-Boundary\-Conditions}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{set\-Boundary\-Conditions}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::set\-Boundary\-Conditions (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_a379807f0bf932b40aeb42065633fce60}


set boundary conditions in ghost layers (set boundary conditions) 

set the values of all ghost cells depending on the specifed boundary conditions
\begin{DoxyItemize}
\item set boundary conditions for typs W\-A\-L\-L and O\-U\-T\-F\-L\-O\-W
\item derived classes need to transfer ghost layers 
\end{DoxyItemize}

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_a01d0db0b1c5e7b0fbb1bb886382ba3ce}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!set\-Boundary\-Type@{set\-Boundary\-Type}}
\index{set\-Boundary\-Type@{set\-Boundary\-Type}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{set\-Boundary\-Type}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::set\-Boundary\-Type (
\begin{DoxyParamCaption}
\item[{{\bf Boundary\-Edge}}]{edge, }
\item[{{\bf Boundary\-Type}}]{boundtype, }
\item[{const {\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$}]{i\-\_\-inflow = {\ttfamily NULL}}
\end{DoxyParamCaption}
)}\label{classSWE__Block_aa220b93e43b10f56c72a44d7363645c1}


set type of boundary condition for the specified boundary 

Set the boundary type for specific block boundary.


\begin{DoxyParams}{Parameters}
{\em i\-\_\-edge} & location of the edge relative to the S\-W\-E\-\_\-block. \\
\hline
{\em i\-\_\-boundary\-Type} & type of the boundary condition. \\
\hline
{\em i\-\_\-inflow} & pointer to an \doxyref{S\-W\-E\-\_\-\-Block1\-D}{p.}{structSWE__Block1D}, which specifies the inflow (should be N\-U\-L\-L for W\-A\-L\-L or O\-U\-T\-F\-L\-O\-W boundary) \\
\hline
\end{DoxyParams}
\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!set\-Discharge@{set\-Discharge}}
\index{set\-Discharge@{set\-Discharge}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{set\-Discharge}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::set\-Discharge (
\begin{DoxyParamCaption}
\item[{float($\ast$)(float, float)}]{\-\_\-u, }
\item[{float($\ast$)(float, float)}]{\-\_\-v}
\end{DoxyParamCaption}
)}\label{classSWE__Block_a245332c325fd0ff6a7e9c2d3d9454970}


set the momentum/discharge according to the provided functions 

set discharge in all interior grid cells (i.\-e. except ghost layer) to values specified by parameter functions Note\-: unknowns hu and hv represent momentum, while parameters u and v are velocities! \index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!set\-Ghost\-Layer@{set\-Ghost\-Layer}}
\index{set\-Ghost\-Layer@{set\-Ghost\-Layer}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{set\-Ghost\-Layer}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::set\-Ghost\-Layer (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classSWE__Block_afd17334abee3145e27cc3c9b7b935da2}


set values in ghost layers 

set the values of all ghost cells depending on the specifed boundary conditions; if the ghost layer replicates the variables of a remote \doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block}, the values are copied \index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!set\-Water\-Height@{set\-Water\-Height}}
\index{set\-Water\-Height@{set\-Water\-Height}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{set\-Water\-Height}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::set\-Water\-Height (
\begin{DoxyParamCaption}
\item[{float($\ast$)(float, float)}]{\-\_\-h}
\end{DoxyParamCaption}
)}\label{classSWE__Block_a6481ce1c80a219fbefefdcbd13ed3688}


set the water height according to a given function 

set water height h in all interior grid cells (i.\-e. except ghost layer) to values specified by parameter function \-\_\-h \index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!simulate@{simulate}}
\index{simulate@{simulate}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{simulate}]{\setlength{\rightskip}{0pt plus 5cm}float S\-W\-E\-\_\-\-Block\-::simulate (
\begin{DoxyParamCaption}
\item[{float}]{i\-\_\-t\-Start, }
\item[{float}]{i\-\_\-t\-End}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\label{classSWE__Block_a69784e2be2d09035fb2af9d306768f07}
perform the simulation starting with simulation time t\-Start, until simulation time t\-End is reached

simulate implements the main simulation loop between two checkpoints; Note\-: this implementation can only be used, if you only use a single \doxyref{S\-W\-E\-\_\-\-Block}{p.}{classSWE__Block} and only apply simple boundary conditions! In particular, \doxyref{S\-W\-E\-\_\-\-Block\-::simulate}{p.}{classSWE__Block_a69784e2be2d09035fb2af9d306768f07} can not trigger calls to exchange values of copy and ghost layers between blocks! 
\begin{DoxyParams}{Parameters}
{\em t\-Start} & time where the simulation is started \\
\hline
{\em t\-End} & time of the next checkpoint \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
actual end time reached 
\end{DoxyReturn}


Reimplemented in {\bf S\-W\-E\-\_\-\-Wave\-Propagation\-Block\-S\-I\-M\-D} \doxyref{}{p.}{classSWE__WavePropagationBlockSIMD_a6c54dbcd43a77b46bae4de36b8d16af7}, {\bf S\-W\-E\-\_\-\-Wave\-Propagation\-Block\-Cuda} \doxyref{}{p.}{classSWE__WavePropagationBlockCuda_aa7cb155a2c8a76171fa39daff2b30ce3}, {\bf S\-W\-E\-\_\-\-Rusanov\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__RusanovBlockCUDA_a42c63cf7d3c5609768aa28263393efb6}, and {\bf S\-W\-E\-\_\-\-Rusanov\-Block} \doxyref{}{p.}{classSWE__RusanovBlock_a645322106b3e5b6f0cca077611ad2159}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!simulate\-Timestep@{simulate\-Timestep}}
\index{simulate\-Timestep@{simulate\-Timestep}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{simulate\-Timestep}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::simulate\-Timestep (
\begin{DoxyParamCaption}
\item[{float}]{dt}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\label{classSWE__Block_add6908e1ceb261a0a1f3ebc262cc5f11}


execute a single time step (with fixed time step size) of the simulation 

Executes a single timestep with fixed time step size
\begin{DoxyItemize}
\item compute net updates for every edge
\item update cell values with the net updates
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em dt} & time step width of the update \\
\hline
\end{DoxyParams}


Reimplemented in {\bf S\-W\-E\-\_\-\-Wave\-Propagation\-Block\-S\-I\-M\-D} \doxyref{}{p.}{classSWE__WavePropagationBlockSIMD_a99c288632c402eaf7dff76f03624872a}, {\bf S\-W\-E\-\_\-\-Wave\-Propagation\-Block\-Cuda} \doxyref{}{p.}{classSWE__WavePropagationBlockCuda_a1e79efd0b3f90e793add52fd5155410a}, {\bf S\-W\-E\-\_\-\-Rusanov\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__RusanovBlockCUDA_aa039b202a505cf31ab16e8c74dc4153b}, and {\bf S\-W\-E\-\_\-\-Rusanov\-Block} \doxyref{}{p.}{classSWE__RusanovBlock_ada062db4f54700011d50378b0045830a}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!synch\-After\-Write@{synch\-After\-Write}}
\index{synch\-After\-Write@{synch\-After\-Write}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{synch\-After\-Write}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::synch\-After\-Write (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_ae914f9bf6d4ef8f974f9f005114985e7}
Update all temporary and non-\/local (for heterogeneous computing) variables after an external update of the main variables h, hu, hv, and b. 

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_ac0df7dd281db264b3ce06d8ae6d4c004}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!synch\-Bathymetry\-After\-Write@{synch\-Bathymetry\-After\-Write}}
\index{synch\-Bathymetry\-After\-Write@{synch\-Bathymetry\-After\-Write}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{synch\-Bathymetry\-After\-Write}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::synch\-Bathymetry\-After\-Write (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_a4bece8aa90f67e55c40b91aab900febb}
Update temporary and non-\/local (for heterogeneous computing) variables after an external update of the bathymetry b 

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_afb390e026d984f3a33727addcd9c6f00}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!synch\-Bathymetry\-Before\-Read@{synch\-Bathymetry\-Before\-Read}}
\index{synch\-Bathymetry\-Before\-Read@{synch\-Bathymetry\-Before\-Read}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{synch\-Bathymetry\-Before\-Read}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::synch\-Bathymetry\-Before\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_a7c8258c6949518ca44f4e9ce89d33b09}
Update temporary and non-\/local (for heterogeneous computing) variables before an external access to the bathymetry b 

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_a8c5ee2bb3afadf44451a434dbd1cba6e}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!synch\-Before\-Read@{synch\-Before\-Read}}
\index{synch\-Before\-Read@{synch\-Before\-Read}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{synch\-Before\-Read}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::synch\-Before\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_a23d936cb9a4367092e5b2515f81fe819}
Update all temporary and non-\/local (for heterogeneous computing) variables before an external access to the main variables h, hu, hv, and b. 

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_aa81487c41270362dfcaafdd911ec358d}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!synch\-Copy\-Layer\-Before\-Read@{synch\-Copy\-Layer\-Before\-Read}}
\index{synch\-Copy\-Layer\-Before\-Read@{synch\-Copy\-Layer\-Before\-Read}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{synch\-Copy\-Layer\-Before\-Read}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::synch\-Copy\-Layer\-Before\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_a13c90d5a6596336013c41e73c8795f83}
Update (for heterogeneous computing) variables in copy layers before an external access to the unknowns 

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_af14ae578fc5afa8d85ca94c827c1d310}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!synch\-Discharge\-After\-Write@{synch\-Discharge\-After\-Write}}
\index{synch\-Discharge\-After\-Write@{synch\-Discharge\-After\-Write}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{synch\-Discharge\-After\-Write}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::synch\-Discharge\-After\-Write (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_a94c34030153178c9d94f3f14be174eaf}
Update temporary and non-\/local (for heterogeneous computing) variables after an external update of the discharge variables hu and hv 

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_a01274791529721345e4611e40942a006}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!synch\-Discharge\-Before\-Read@{synch\-Discharge\-Before\-Read}}
\index{synch\-Discharge\-Before\-Read@{synch\-Discharge\-Before\-Read}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{synch\-Discharge\-Before\-Read}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::synch\-Discharge\-Before\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_a3773dcb194212fb8cb40ab8465575aa1}
Update temporary and non-\/local (for heterogeneous computing) variables before an external access to the discharge variables hu and hv 

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_ab244fbc1c2a926806a489c67d8644cf2}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!synch\-Ghost\-Layer\-After\-Write@{synch\-Ghost\-Layer\-After\-Write}}
\index{synch\-Ghost\-Layer\-After\-Write@{synch\-Ghost\-Layer\-After\-Write}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{synch\-Ghost\-Layer\-After\-Write}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::synch\-Ghost\-Layer\-After\-Write (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_a4657993ebdb5f0132b077e63790d0b2b}
Update the ghost layers (only for C\-O\-N\-N\-E\-C\-T and P\-A\-S\-S\-I\-V\-E boundary conditions) after an external update of the main variables h, hu, hv, and b in the ghost layer. 

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_ac2f31de45c6aee8ca5a54e8bec4d64c7}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!synch\-Water\-Height\-After\-Write@{synch\-Water\-Height\-After\-Write}}
\index{synch\-Water\-Height\-After\-Write@{synch\-Water\-Height\-After\-Write}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{synch\-Water\-Height\-After\-Write}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::synch\-Water\-Height\-After\-Write (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_aa2924833e29a795d8c04fb79bfe794de}
Update temporary and non-\/local (for heterogeneous computing) variables after an external update of the water height h 

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_af15f84ed38f89f62b33a7b56daec84c8}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!synch\-Water\-Height\-Before\-Read@{synch\-Water\-Height\-Before\-Read}}
\index{synch\-Water\-Height\-Before\-Read@{synch\-Water\-Height\-Before\-Read}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{synch\-Water\-Height\-Before\-Read}]{\setlength{\rightskip}{0pt plus 5cm}void S\-W\-E\-\_\-\-Block\-::synch\-Water\-Height\-Before\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\label{classSWE__Block_a07c85681ab29106c3b164db969899ace}
Update temporary and non-\/local (for heterogeneous computing) variables before an external access to the water height h 

Reimplemented in {\bf S\-W\-E\-\_\-\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__BlockCUDA_abb2738cc673335b52d1cac2e0d8cfc53}.

\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!update\-Unknowns@{update\-Unknowns}}
\index{update\-Unknowns@{update\-Unknowns}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{update\-Unknowns}]{\setlength{\rightskip}{0pt plus 5cm}virtual void S\-W\-E\-\_\-\-Block\-::update\-Unknowns (
\begin{DoxyParamCaption}
\item[{float}]{dt}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [pure virtual]}}\label{classSWE__Block_ab2b4b659f23d5d45413dece8d2da3298}


compute the new values of the unknowns h, hu, and hv in all grid cells 

based on the numerical fluxes (computed by compute\-Numerical\-Fluxes) and the specified time step size dt, an Euler time step is executed. As the computational fluxes will depend on the numerical method, this purely virtual function has to be implemented separately for each specific numerical model (and parallelisation approach). 
\begin{DoxyParams}{Parameters}
{\em dt} & size of the time step \\
\hline
\end{DoxyParams}


Implemented in {\bf S\-W\-E\-\_\-\-Dimensional\-Splitting} \doxyref{}{p.}{classSWE__DimensionalSplitting_af74b527ff9ca7727442db92d2e438531}, {\bf S\-W\-E\-\_\-\-Wave\-Propagation\-Block\-S\-I\-M\-D} \doxyref{}{p.}{classSWE__WavePropagationBlockSIMD_a2596238868efd3cdd453d9ac2de15997}, {\bf S\-W\-E\-\_\-\-Wave\-Propagation\-Block} \doxyref{}{p.}{classSWE__WavePropagationBlock_a1b1422472a36602b34180e4ed27f6d8c}, {\bf S\-W\-E\-\_\-\-Wave\-Propagation\-Block\-Cuda} \doxyref{}{p.}{classSWE__WavePropagationBlockCuda_a4163045a47a73515841e754ca3859fc5}, {\bf S\-W\-E\-\_\-\-Wave\-Accumulation\-Block} \doxyref{}{p.}{classSWE__WaveAccumulationBlock_a67b78723e81aec6e661b3710e6c41b43}, {\bf S\-W\-E\-\_\-\-Rusanov\-Block} \doxyref{}{p.}{classSWE__RusanovBlock_a2980aa21030ba8fc607001ad817d7454}, and {\bf S\-W\-E\-\_\-\-Rusanov\-Block\-C\-U\-D\-A} \doxyref{}{p.}{classSWE__RusanovBlockCUDA_a037264d8f044fd4d323420562c82a218}.



\subsection{Member Data Documentation}
\index{S\-W\-E\-\_\-\-Block@{S\-W\-E\-\_\-\-Block}!max\-Timestep@{max\-Timestep}}
\index{max\-Timestep@{max\-Timestep}!SWE_Block@{S\-W\-E\-\_\-\-Block}}
\subsubsection[{max\-Timestep}]{\setlength{\rightskip}{0pt plus 5cm}float S\-W\-E\-\_\-\-Block\-::max\-Timestep\hspace{0.3cm}{\ttfamily [protected]}}\label{classSWE__Block_a05cbc9b40e0483bf73dbc2bdeae7dee3}


maximum time step allowed to ensure stability of the method 

max\-Timestep can be updated as part of the methods compute\-Numerical\-Fluxes and update\-Unknowns (depending on the numerical method) 

The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
src/blocks/{\bf S\-W\-E\-\_\-\-Block.\-hh}\item 
src/blocks/{\bf S\-W\-E\-\_\-\-Block.\-cpp}\end{DoxyCompactItemize}
